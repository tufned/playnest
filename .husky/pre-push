#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

# Check for changes in @playnest/core
CHANGED=$(git diff --name-only HEAD~1 HEAD packages/core/ | wc -l)

if [ "$CHANGED" -gt 0 ]; then
  echo "ğŸ” Changes detected in @playnest/core. Launching publishing..."

  echo "ğŸ“¦ Building..."
  pnpm build --filter @playnest/core

  cd packages/core || exit

  echo "ğŸš€ Updating package version..."
  npm version patch --no-git-tag-version

  echo "ğŸ“¤ Publishing to npm..."
  npm publish

  cd ../../

  echo "âœ… Published"
else
  echo "â„¹ï¸ No changes in @playnest/core, skip publishing"
fi
undefined
